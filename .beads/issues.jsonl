{"id":"photosort-2j7","title":"HIGH: Fix private member access in photosort.py","description":"photosort.py:73 directly accesses self._photodb._output_dir which violates encapsulation.\n\nCurrent code:\n  media_file.move_to_directory_with_date(\n    self._photodb._output_dir,  # Accessing private member\n\nShould use:\n  media_file.move_to_directory_with_date(\n    self._config.output_dir(),  # Use public interface\n\nImpact: Violates encapsulation, makes refactoring harder\nEffort: 2 minutes","status":"closed","priority":1,"issue_type":"task","assignee":"@me","estimated_minutes":2,"created_at":"2026-01-08T13:24:59.166443+01:00","created_by":"ajo","updated_at":"2026-01-08T13:27:42.479543+01:00","closed_at":"2026-01-08T13:27:42.479543+01:00","close_reason":"Closed"}
{"id":"photosort-901","title":"HIGH: Add proper exit codes on error in main()","description":"photosort.py:158 catches exceptions but doesn't set exit code to 1. This means deployment scripts/cron jobs cannot detect failures.\n\nCurrent code:\n  except Exception:\n    logging.critical(...)\n    # Missing: sys.exit(1)\n\nShould add:\n  except Exception:\n    logging.critical(...)\n    sys.exit(1)\n\nImpact: Production reliability, failure detection\nEffort: 2 minutes","status":"closed","priority":1,"issue_type":"task","assignee":"@me","estimated_minutes":2,"created_at":"2026-01-08T13:24:59.461593+01:00","created_by":"ajo","updated_at":"2026-01-08T13:28:18.386081+01:00","closed_at":"2026-01-08T13:28:18.386081+01:00","close_reason":"Closed"}
{"id":"photosort-bh0","title":"LOW: Use os.path.relpath() in photodb.py","description":"photodb.py:96 does simple string slicing to make paths relative, which could fail with symlinks or if path doesn't start with output_dir.\n\nCurrent code:\n  file_dir = file_dir[len(self._output_dir) + 1:]\n\nShould use:\n  file_dir = os.path.relpath(file_dir, self._output_dir)\n\nImpact: Robustness with edge cases\nEffort: 5 minutes","status":"closed","priority":3,"issue_type":"task","assignee":"@me","estimated_minutes":5,"created_at":"2026-01-08T13:25:01.492611+01:00","created_by":"ajo","updated_at":"2026-01-08T13:31:52.303904+01:00","closed_at":"2026-01-08T13:31:52.303904+01:00","close_reason":"Closed"}
{"id":"photosort-cdo","title":"MEDIUM: Add deprecation warnings for legacy config keys","description":"config.py:52-59 and :61-68 support legacy 'pattern' config key with awkward string comparison of exceptions.\n\nCurrent issues:\n- Comparing exception strings is brittle\n- No deprecation warning for users\n- Makes code harder to maintain\n\nRecommendation: Replace with clear dictionary checks and add logging.warning() for deprecated keys.\n\nImpact: Better UX, code maintainability\nEffort: 15 minutes","status":"closed","priority":2,"issue_type":"task","assignee":"@me","estimated_minutes":15,"created_at":"2026-01-08T13:25:00.335803+01:00","created_by":"ajo","updated_at":"2026-01-08T13:30:37.038381+01:00","closed_at":"2026-01-08T13:30:37.038381+01:00","close_reason":"Closed"}
{"id":"photosort-cdu","title":"Improve test coverage and test quality","description":"Implement comprehensive test suite to increase coverage and ensure behavior testing (not external library testing). Target 85%+ line coverage on core modules.","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-08T12:35:08.383851+01:00","created_by":"ajo","updated_at":"2026-01-08T12:35:08.383851+01:00"}
{"id":"photosort-cdu.1","title":"Add Config module tests (test_004_config.py)","description":"Test YAML configuration parsing and all Config class methods. Test behavior: valid/invalid YAML, relative/absolute paths, octal chmod parsing, backward compatibility (pattern vs dir_pattern), optional field defaults.","status":"closed","priority":1,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-08T12:35:33.538273+01:00","created_by":"ajo","updated_at":"2026-01-08T12:44:43.790223+01:00","closed_at":"2026-01-08T12:44:43.790223+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-cdu.1","depends_on_id":"photosort-cdu","type":"parent-child","created_at":"2026-01-08T12:35:33.539446+01:00","created_by":"ajo"}]}
{"id":"photosort-cdu.10","title":"Document testing best practices and philosophy","description":"Update CLAUDE.md with testing philosophy: behavior testing vs implementation testing, mocking external dependencies, avoiding testing library internals. Document how to run coverage reports and interpret results.","status":"closed","priority":2,"issue_type":"task","estimated_minutes":30,"created_at":"2026-01-08T12:36:32.803464+01:00","created_by":"ajo","updated_at":"2026-01-08T13:08:22.843704+01:00","closed_at":"2026-01-08T13:08:22.843704+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-cdu.10","depends_on_id":"photosort-cdu","type":"parent-child","created_at":"2026-01-08T12:36:32.804774+01:00","created_by":"ajo"}]}
{"id":"photosort-cdu.2","title":"Add PhotoDB module tests (test_005_photodb.py)","description":"Test CSV-based database operations. Test behavior: create/load/write database, add entries, duplicate detection by hash, hash collision handling, backup file creation, merge mode, missing/corrupted DB handling, path prefix stripping.","status":"closed","priority":1,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-08T12:35:33.846652+01:00","created_by":"ajo","updated_at":"2026-01-08T12:46:28.850059+01:00","closed_at":"2026-01-08T12:46:28.850059+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-cdu.2","depends_on_id":"photosort-cdu","type":"parent-child","created_at":"2026-01-08T12:35:33.847761+01:00","created_by":"ajo"}]}
{"id":"photosort-cdu.3","title":"Add PhotoSort integration tests (test_006_photosort_integration.py)","description":"Test main orchestration workflow. Test behavior: sync() operation end-to-end, rebuilddb() operation, duplicate detection and movement, file permission setting, handling files without EXIF, multiple sources, database updates.","status":"closed","priority":1,"issue_type":"task","estimated_minutes":150,"created_at":"2026-01-08T12:35:34.14738+01:00","created_by":"ajo","updated_at":"2026-01-08T12:51:44.115965+01:00","closed_at":"2026-01-08T12:51:44.115965+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-cdu.3","depends_on_id":"photosort-cdu","type":"parent-child","created_at":"2026-01-08T12:35:34.148468+01:00","created_by":"ajo"}]}
{"id":"photosort-cdu.4","title":"Enhance WalkForMedia tests (expand test_001)","description":"Expand existing walk tests. Test behavior: ignore list functionality, hidden directory filtering, extension filtering, filesystem time skew, file readiness checks (empty/locked/recently modified), missing directories, AppleDouble file filtering.","status":"closed","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-08T12:35:44.140287+01:00","created_by":"ajo","updated_at":"2026-01-08T13:02:10.305224+01:00","closed_at":"2026-01-08T13:02:10.305224+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-cdu.4","depends_on_id":"photosort-cdu","type":"parent-child","created_at":"2026-01-08T12:35:44.141532+01:00","created_by":"ajo"}]}
{"id":"photosort-cdu.5","title":"Add error handling tests (test_007_error_handling.py)","description":"Test robustness and error recovery. Test behavior: missing source/output directories, unwritable files/directories, file disappears during processing, concurrent access, invalid permissions in config, YAML parse errors.","status":"closed","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-08T12:35:44.451489+01:00","created_by":"ajo","updated_at":"2026-01-08T13:12:11.023594+01:00","closed_at":"2026-01-08T13:12:11.023594+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-cdu.5","depends_on_id":"photosort-cdu","type":"parent-child","created_at":"2026-01-08T12:35:44.453022+01:00","created_by":"ajo"}]}
{"id":"photosort-cdu.6","title":"Enhance MediaFile edge case tests","description":"Add edge cases to existing test files. Test behavior: all supported file extensions, unknown file types, file comparison edge cases, makedirs_f with partial paths, rename_as failures, all EXIF tag fallbacks, malformed datetime, zero datetime handling.","status":"closed","priority":2,"issue_type":"task","estimated_minutes":75,"created_at":"2026-01-08T12:35:44.756351+01:00","created_by":"ajo","updated_at":"2026-01-08T13:14:19.366449+01:00","closed_at":"2026-01-08T13:14:19.366449+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-cdu.6","depends_on_id":"photosort-cdu","type":"parent-child","created_at":"2026-01-08T12:35:44.757664+01:00","created_by":"ajo"}]}
{"id":"photosort-cdu.7","title":"Add monitor mode tests (test_008_monitor.py)","description":"Test monitor loop behavior. Test behavior: monitor runs sync repeatedly (mock time.sleep), graceful exception handling during monitoring. Keep simple - verify loop behavior, not timing.","status":"closed","priority":3,"issue_type":"task","estimated_minutes":45,"created_at":"2026-01-08T12:35:53.683435+01:00","created_by":"ajo","updated_at":"2026-01-08T13:16:14.011596+01:00","closed_at":"2026-01-08T13:16:14.011596+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-cdu.7","depends_on_id":"photosort-cdu","type":"parent-child","created_at":"2026-01-08T12:35:53.684667+01:00","created_by":"ajo"}]}
{"id":"photosort-cdu.8","title":"Add pytest-cov and coverage reporting","description":"Add pytest-cov to dev dependencies. Configure coverage reporting in pyproject.toml. Set up coverage thresholds. Document how to run coverage reports in CLAUDE.md.","status":"closed","priority":2,"issue_type":"task","estimated_minutes":30,"created_at":"2026-01-08T12:35:53.986852+01:00","created_by":"ajo","updated_at":"2026-01-08T13:05:55.893757+01:00","closed_at":"2026-01-08T13:05:55.893757+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-cdu.8","depends_on_id":"photosort-cdu","type":"parent-child","created_at":"2026-01-08T12:35:53.988129+01:00","created_by":"ajo"}]}
{"id":"photosort-cdu.9","title":"Consider pytest-mock migration","description":"Evaluate replacing 'mock' library with pytest-mock for better pytest integration. Update existing tests if beneficial. Document decision.","status":"open","priority":3,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-08T12:35:54.294017+01:00","created_by":"ajo","updated_at":"2026-01-08T12:35:54.294017+01:00","dependencies":[{"issue_id":"photosort-cdu.9","depends_on_id":"photosort-cdu","type":"parent-child","created_at":"2026-01-08T12:35:54.295237+01:00","created_by":"ajo"}]}
{"id":"photosort-gnf","title":"MEDIUM: Handle missing exiftool gracefully","description":"photosort.py:135 has TODO comment about handling missing exiftool. Should provide clear error message when exiftool is not installed.\n\nRecommended implementation:\n  try:\n    exif.start()\n  except FileNotFoundError:\n    logging.critical('exiftool is not installed. Please install it:')\n    logging.critical('  Ubuntu/Debian: sudo apt-get install exiftool')\n    logging.critical('  macOS: brew install exiftool')\n    sys.exit(1)\n\nImpact: Better user experience, common pain point\nEffort: 10 minutes","status":"closed","priority":2,"issue_type":"task","assignee":"@me","estimated_minutes":10,"created_at":"2026-01-08T13:24:59.751813+01:00","created_by":"ajo","updated_at":"2026-01-08T13:28:59.568485+01:00","closed_at":"2026-01-08T13:28:59.568485+01:00","close_reason":"Closed"}
{"id":"photosort-hzs","title":"Add YOLO11 object detection tagging feature","description":"Add capability to scan photos in output directory using YOLO11 and tag them with detected objects. This enables AI-powered photo organization and searchability.\n\nKey requirements:\n- New 'add-yolo-tags' command\n- Config section for YOLO settings (model path, confidence threshold, device)\n- Default model: yolo11x.pt\n- Store tags in EXIF keywords or sidecar files\n- Support batch processing of existing photos\n- Use COCO dataset test images for validation\n\nArchitecture:\n- New yolo_tagger.py module for YOLO operations\n- Extend config.py for yolo section\n- Add command to photosort.py CLI\n- Device detection (MPS for Apple Silicon, CUDA for NVIDIA, CPU fallback)\n\nDependencies:\n- ultralytics package\n- torch (with MPS/CUDA support)\n\nTesting strategy:\n- Unit tests for YOLO tag extraction\n- Integration tests with real COCO images\n- Config parsing tests\n- End-to-end workflow tests","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-08T22:43:22.344424+01:00","created_by":"ajo","updated_at":"2026-01-08T23:12:14.46697+01:00","closed_at":"2026-01-08T23:12:14.46697+01:00","close_reason":"Closed"}
{"id":"photosort-hzs.1","title":"Create yolo_tagger.py module with YOLO11 integration","description":"Create new module src/photosort/yolo_tagger.py that handles YOLO11 object detection and tagging.\n\nImplementation details:\n- YoloTagger class with methods:\n  - __init__(model_path, confidence): Initialize YOLO model (device auto-detected by ultralytics)\n  - detect_objects(image_path): Run inference on image file, return list of detected object labels\n  - get_unique_labels(results): Extract unique object class names from YOLO results (no bbox coordinates)\n  - add_tags_to_photo(photo_path, tags): Write object labels as EXIF Keywords field using exiftool\n  - visualize_detections(image_path, results): Optional - show annotated image with cv2.imshow if display available\n  \n- Read images from file paths (not camera/video)\n- Extract only object class names (e.g., 'cat', 'dog', 'airplane') - NO coordinates/bboxes stored\n- Support batch processing for efficiency\n- Optional interactive visualization with cv2.imshow when display available\n- Log detections and tagging operations\n- Handle errors gracefully (missing model, unsupported images, etc)\n\nReference: yolo11/demo.py for visualization patterns (results[0].plot())","status":"closed","priority":2,"issue_type":"task","estimated_minutes":120,"created_at":"2026-01-08T22:43:31.654536+01:00","created_by":"ajo","updated_at":"2026-01-08T22:55:20.303452+01:00","closed_at":"2026-01-08T22:55:20.303452+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-hzs.1","depends_on_id":"photosort-hzs","type":"parent-child","created_at":"2026-01-08T22:43:31.656027+01:00","created_by":"ajo"}]}
{"id":"photosort-hzs.2","title":"Extend config.py to support YOLO configuration section","description":"Add YOLO configuration section parsing to config.py.\n\nConfig structure (in YAML):\nyolo:\n  model: 'yolo11x.pt'  # default - auto-downloads if not found\n  confidence: 0.25      # default confidence threshold\n  imgsz: 640           # image size for inference\n  interactive: false   # show cv2 visualization window (requires display)\n\nImplementation:\n- Add yolo_model(), yolo_confidence(), yolo_imgsz(), yolo_interactive() methods to Config class\n- Provide sensible defaults if yolo section is missing\n- NO device parameter - let ultralytics auto-detect (it handles MPS/CUDA/CPU automatically)\n- Validate model path (check if file exists or is downloadable YOLO model name)\n- Ensure backward compatibility with existing configs without yolo section\n\nTesting:\n- Test with yolo section present\n- Test with partial yolo config (some fields missing)\n- Test with no yolo section (all defaults)\n- Test invalid model paths\n- Test interactive mode flag","status":"closed","priority":2,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-08T22:44:44.463529+01:00","created_by":"ajo","updated_at":"2026-01-08T22:54:40.245604+01:00","closed_at":"2026-01-08T22:54:40.245604+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-hzs.2","depends_on_id":"photosort-hzs","type":"parent-child","created_at":"2026-01-08T22:44:44.464493+01:00","created_by":"ajo"}]}
{"id":"photosort-hzs.3","title":"Add add-yolo-tags command to PhotoSort CLI","description":"Implement the add-yolo-tags operation in photosort.py.\n\nChanges needed:\n1. Add 'add-yolo-tags' to argparse choices (line 157)\n2. Add optional --interactive flag for cv2 visualization display\n3. Add add_yolo_tags() method to PhotoSort class:\n   - Walk output directory using WalkForMedia\n   - For each photo file (skip movies initially):\n     * Initialize YoloTagger with config settings\n     * Run object detection on image file\n     * Extract unique class labels (e.g., 'cat', 'dog', 'person')\n     * Add labels as EXIF keywords (just label names, no coordinates)\n     * If interactive mode: show cv2 window with annotated image\n     * Log progress (X of Y processed, labels found)\n   - Report summary: total processed, tagged, errors\n   \n4. Wire up command in main() function (around line 197)\n5. Import yolo_tagger module\n6. Add optional --dry-run flag to preview tags without writing\n7. Handle KeyboardInterrupt gracefully in interactive mode\n\nIMPORTANT: Only store object class names in EXIF (e.g., 'cat', 'dog', 'airplane'), NOT bounding box coordinates or locations\n\nError handling:\n- Handle missing ultralytics/torch dependencies gracefully with helpful error\n- Skip unsupported image formats\n- Continue on individual file errors, report at end\n- Check if display available for interactive mode (cv2.imshow may fail headless)","status":"closed","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-08T22:44:53.083858+01:00","created_by":"ajo","updated_at":"2026-01-08T22:56:11.185393+01:00","closed_at":"2026-01-08T22:56:11.185393+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-hzs.3","depends_on_id":"photosort-hzs","type":"parent-child","created_at":"2026-01-08T22:44:53.084898+01:00","created_by":"ajo"}]}
{"id":"photosort-hzs.4","title":"Download COCO test images for YOLO testing","description":"Download sample images from COCO dataset for testing YOLO tagging functionality.\n\nImages to download (to src/photosort/test/data/coco/):\n1. http://farm4.staticflickr.com/3656/3397279402_063b7d7139_z.jpg (boats scene)\n2. http://farm8.staticflickr.com/7249/7475454508_5c8df17d23_z.jpg (street scene)\n3. Consider 2-3 additional diverse images (indoor, animals, people, etc)\n\nImplementation:\n- Create test/data/coco/ directory\n- Download images (can use wget/curl or Python requests)\n- Add README.md documenting image sources and expected detections\n- Keep images under 500KB each for reasonable repo size\n\nExpected detections (for validation):\n- Image 1: boat, person, water\n- Image 2: bus, person, car, traffic light","status":"closed","priority":2,"issue_type":"task","estimated_minutes":30,"created_at":"2026-01-08T22:45:01.500994+01:00","created_by":"ajo","updated_at":"2026-01-08T22:54:20.488699+01:00","closed_at":"2026-01-08T22:54:20.488699+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-hzs.4","depends_on_id":"photosort-hzs","type":"parent-child","created_at":"2026-01-08T22:45:01.501891+01:00","created_by":"ajo"}]}
{"id":"photosort-hzs.5","title":"Create unit tests for yolo_tagger module","description":"Create comprehensive unit tests in test/testcases/test_007_yolo_tagger.py.\n\nTest coverage:\n1. TestYoloTaggerInit:\n   - test_model_loading_success (yolo11x.pt or yolo11n.pt for speed)\n   - test_model_loading_missing_file\n   - test_invalid_confidence_values\n   - test_auto_download_model (if model not present)\n\n2. TestYoloObjectDetection:\n   - test_detect_objects_coco_boats (verify labels: boat, person)\n   - test_detect_objects_coco_street (verify labels: bus, car, person, traffic light)\n   - test_detect_objects_returns_class_names_only (no coordinates/bboxes)\n   - test_detect_objects_empty_image\n   - test_detect_objects_invalid_file\n   - test_get_unique_labels_deduplication\n   - test_confidence_threshold_filtering\n\n3. TestYoloTagging:\n   - test_add_tags_to_photo_exif_write\n   - test_add_tags_to_photo_verify_readback (read keywords with exiftool)\n   - test_tags_are_label_names_not_coordinates\n   - test_add_tags_existing_keywords_merge\n   - test_add_tags_to_readonly_file\n\n4. TestYoloVisualization (optional):\n   - test_visualize_detections_creates_annotated_image\n   - Mock cv2.imshow to avoid requiring display\n\nMock strategy:\n- Mock YOLO model for fast tests (except integration tests)\n- Use real COCO images for integration tests\n- Mock exiftool calls for unit tests, real exiftool for integration\n- NO device detection tests (ultralytics handles automatically)","status":"closed","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-08T22:45:11.417227+01:00","created_by":"ajo","updated_at":"2026-01-08T22:57:08.097387+01:00","closed_at":"2026-01-08T22:57:08.097387+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-hzs.5","depends_on_id":"photosort-hzs","type":"parent-child","created_at":"2026-01-08T22:45:11.418644+01:00","created_by":"ajo"}]}
{"id":"photosort-hzs.6","title":"Create integration tests for add-yolo-tags command","description":"Create end-to-end integration tests in test/testcases/test_008_yolo_integration.py.\n\nTest scenarios:\n1. TestAddYoloTagsCommand:\n   - test_full_workflow_with_coco_images:\n     * Set up temp output dir with COCO test images\n     * Create test config with yolo section\n     * Run add-yolo-tags command\n     * Verify EXIF keywords written to all images\n     * Verify only class names stored (boat, person, bus, car) - no coordinates\n   \n   - test_batch_processing_multiple_images:\n     * Process 5+ images\n     * Verify all processed successfully\n     * Check performance/timing\n   \n   - test_skip_already_tagged_images (optional feature):\n     * Tag images once\n     * Run command again\n     * Verify behavior (merge vs skip vs replace)\n   \n   - test_error_handling_corrupt_image:\n     * Include one corrupt/invalid image\n     * Verify command completes successfully for valid images\n     * Verify error logged for invalid image\n   \n   - test_dry_run_mode:\n     * Run with --dry-run flag\n     * Verify no EXIF data written\n     * Verify tags would-be-written logged\n\n   - test_interactive_mode_headless:\n     * Run with --interactive flag in headless environment\n     * Verify graceful handling (skip visualization or error)\n\n2. TestYoloConfigIntegration:\n   - test_config_with_yolo_section\n   - test_config_without_yolo_section_defaults\n   - test_config_with_custom_model\n   - test_config_interactive_flag\n\n3. TestYoloExifTagFormat:\n   - test_tags_are_simple_labels (no JSON, no coordinates)\n   - test_tags_readable_by_standard_tools\n   - test_multiple_objects_comma_separated_or_array\n\nUse real YOLO model for integration tests (auto-download yolo11n.pt for speed).\nFocus on verifying that ONLY object class names are stored, never coordinates.","status":"closed","priority":2,"issue_type":"task","estimated_minutes":90,"created_at":"2026-01-08T22:45:21.805622+01:00","created_by":"ajo","updated_at":"2026-01-08T22:58:09.711596+01:00","closed_at":"2026-01-08T22:58:09.711596+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-hzs.6","depends_on_id":"photosort-hzs","type":"parent-child","created_at":"2026-01-08T22:45:21.807948+01:00","created_by":"ajo"}]}
{"id":"photosort-hzs.7","title":"Add ultralytics and torch dependencies to pyproject.toml","description":"Update project dependencies to include YOLO11 requirements.\n\nChanges to pyproject.toml:\n1. Add to dependencies:\n   - ultralytics\u003e=8.0.0 (YOLO11 is part of ultralytics package)\n   - torch\u003e=2.0.0 (required by ultralytics)\n   - opencv-python\u003e=4.8.0 (required for image handling)\n\n2. Consider making YOLO dependencies optional:\n   [project.optional-dependencies]\n   yolo = [\n       'ultralytics\u003e=8.0.0',\n       'torch\u003e=2.0.0', \n       'opencv-python\u003e=4.8.0'\n   ]\n   \n   This allows users who don't need YOLO features to install lightweight version.\n\n3. Update installation instructions in CLAUDE.md:\n   - Add section for YOLO feature\n   - Document: pip install photosort[yolo]\n   - Note about MPS support for Apple Silicon\n\n4. Ensure dependency resolution doesn't conflict with existing packages\n\n5. Test installation:\n   - make sync\n   - Verify all packages install correctly\n   - Test on macOS (MPS) and Linux (CPU/CUDA)","status":"closed","priority":2,"issue_type":"task","estimated_minutes":30,"created_at":"2026-01-08T22:45:30.669944+01:00","created_by":"ajo","updated_at":"2026-01-08T22:53:37.777216+01:00","closed_at":"2026-01-08T22:53:37.777216+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-hzs.7","depends_on_id":"photosort-hzs","type":"parent-child","created_at":"2026-01-08T22:45:30.671625+01:00","created_by":"ajo"}]}
{"id":"photosort-hzs.8","title":"Update documentation for YOLO tagging feature","description":"Update CLAUDE.md with comprehensive YOLO feature documentation.\n\nSections to add/update:\n\n1. Development Commands - Add YOLO commands:\n   # Add YOLO tags to existing photos\n   uv run photosort --config my_photosort.yaml add-yolo-tags\n   \n   # Preview tags without writing (dry-run)\n   uv run photosort --config my_photosort.yaml add-yolo-tags --dry-run\n   \n   # Interactive mode with visualization (requires display)\n   uv run photosort --config my_photosort.yaml add-yolo-tags --interactive\n\n2. Configuration Structure - Add YOLO section:\n   yolo:\n     model: 'yolo11x.pt'  # Model file (auto-downloads if not found)\n     confidence: 0.25      # Confidence threshold (0.0-1.0)\n     imgsz: 640           # Inference image size\n     interactive: false   # Show cv2 visualization (requires display)\n\n3. Architecture - Add Core Components:\n   **yolo_tagger.py** - YOLO11 object detection and tagging:\n   - Reads image files from disk (not camera/video)\n   - Object detection with configurable confidence\n   - Extracts ONLY class names (e.g., 'cat', 'dog') - no coordinates stored\n   - EXIF keyword tagging via exiftool\n   - Optional cv2 visualization in interactive mode\n   - Device auto-detected by ultralytics (MPS/CUDA/CPU)\n\n4. External Dependencies:\n   - Add note about optional YOLO dependencies\n   - Installation: pip install photosort[yolo]\n   - Model auto-download on first use (yolo11x.pt default)\n   - Device selection automatic (no manual configuration)\n\n5. Add usage examples:\n   - Basic tagging workflow\n   - Interactive mode for reviewing detections\n   - Dry-run to preview before writing\n   - Model size vs accuracy tradeoffs (yolo11n.pt vs yolo11x.pt)\n\n6. Important notes:\n   - Only object class names stored in EXIF (not locations/coordinates)\n   - Works on existing photos in output directory\n   - Respects file permissions from config\n   - Can be run multiple times (tags will merge/update)","status":"closed","priority":2,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-08T22:46:21.446489+01:00","created_by":"ajo","updated_at":"2026-01-08T22:59:57.177247+01:00","closed_at":"2026-01-08T22:59:57.177247+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-hzs.8","depends_on_id":"photosort-hzs","type":"parent-child","created_at":"2026-01-08T22:46:21.447982+01:00","created_by":"ajo"}]}
{"id":"photosort-hzs.9","title":"Implementation order and integration checklist","description":"Follow this recommended implementation order for the YOLO feature:\n\nPhase 1 - Foundation (can work in parallel):\n1. photosort-hzs.7: Add dependencies to pyproject.toml\n2. photosort-hzs.4: Download COCO test images\n\nPhase 2 - Core Implementation (sequential):\n3. photosort-hzs.2: Extend config.py for YOLO section\n4. photosort-hzs.1: Create yolo_tagger.py module\n5. photosort-hzs.3: Add add-yolo-tags CLI command\n\nPhase 3 - Testing (can work in parallel):\n6. photosort-hzs.5: Unit tests for yolo_tagger\n7. photosort-hzs.6: Integration tests for command\n\nPhase 4 - Finalization:\n8. photosort-hzs.8: Update documentation\n9. Run full test suite: make test\n10. Manual testing with real photos\n11. Update CHANGELOG if exists\n\nIntegration checklist:\n- [ ] All tests pass (make test)\n- [ ] Coverage maintained above 75 percent\n- [ ] Documentation updated\n- [ ] Example config includes yolo section\n- [ ] Works with and without yolo dependencies\n- [ ] No device detection code (ultralytics handles automatically)\n- [ ] EXIF tags contain ONLY class names (cat, dog, person) not coordinates\n- [ ] Interactive mode works with display, gracefully fails headless\n- [ ] No breaking changes to existing commands\n- [ ] Error messages helpful for missing dependencies\n\nKey design decisions verified:\n- Read from image files (not camera/video capture)\n- Store only object class names in EXIF Keywords\n- No bounding box coordinates stored\n- Device auto-detection handled by ultralytics library\n- Optional interactive visualization with cv2.imshow","status":"closed","priority":2,"issue_type":"task","estimated_minutes":15,"created_at":"2026-01-08T22:46:36.227329+01:00","created_by":"ajo","updated_at":"2026-01-08T23:12:14.386526+01:00","closed_at":"2026-01-08T23:12:14.386526+01:00","close_reason":"Closed","dependencies":[{"issue_id":"photosort-hzs.9","depends_on_id":"photosort-hzs","type":"parent-child","created_at":"2026-01-08T22:46:36.22992+01:00","created_by":"ajo"}]}
{"id":"photosort-ik7","title":"LOW: Add type hints to public APIs","description":"The codebase has no type hints, making it harder to catch bugs at development time.\n\nRecommendation: Add type hints gradually, starting with public APIs in:\n- WalkForMedia.find_media() -\u003e Generator[Tuple[str, str], None, None]\n- MediaFile.hash() -\u003e str\n- MediaFile.datetime() -\u003e datetime.datetime\n- Config methods\n\nBenefits:\n- Catch bugs at development time (like _output_dir access issue)\n- Better IDE support\n- Improved documentation\n\nImpact: Developer experience\nEffort: Ongoing","status":"open","priority":3,"issue_type":"task","estimated_minutes":60,"created_at":"2026-01-08T13:25:00.619105+01:00","created_by":"ajo","updated_at":"2026-01-08T13:25:00.619105+01:00"}
{"id":"photosort-khl","title":"LOW: Make monitor sleep interval configurable","description":"photosort.py:113 hardcodes 10-second sleep interval in monitor mode.\n\nCurrent code:\n  time.sleep(10)  # Magic number\n\nRecommendation: Either make it a named constant or add to config:\n  output:\n    monitor_interval: 10  # seconds\n\nImpact: Flexibility for different use cases\nEffort: 10 minutes","status":"closed","priority":3,"issue_type":"task","assignee":"@me","estimated_minutes":10,"created_at":"2026-01-08T13:25:00.907584+01:00","created_by":"ajo","updated_at":"2026-01-08T13:32:38.081417+01:00","closed_at":"2026-01-08T13:32:38.081417+01:00","close_reason":"Closed"}
{"id":"photosort-low","title":"MEDIUM: Simplify makedirs_f() implementation","description":"media.py:195-204 has custom makedirs_f() that reimplements os.makedirs(exist_ok=True).\n\nProblems:\n- Doesn't handle empty path components correctly\n- Race condition between isdir() check and mkdir() call\n- Python's os.makedirs() already does this better\n\nRecommendation: Replace with os.makedirs(path, mode=(mode | stat.S_IXUSR), exist_ok=True) or add comment explaining why custom implementation is needed.\n\nImpact: Code clarity, potential race conditions\nEffort: 5 minutes","status":"closed","priority":2,"issue_type":"task","assignee":"@me","estimated_minutes":5,"created_at":"2026-01-08T13:25:00.045585+01:00","created_by":"ajo","updated_at":"2026-01-08T13:29:44.681029+01:00","closed_at":"2026-01-08T13:29:44.681029+01:00","close_reason":"Closed"}
{"id":"photosort-udn","title":"LOW: Document MD5 usage for duplicate detection","description":"media.py:61 uses MD5 for hashing. While acceptable for non-cryptographic duplicate detection, should add comment to prevent future security audit flags.\n\nRecommended comment:\n  # Using MD5 for performance - this is for duplicate detection only,\n  # not cryptographic security. Hash is combined with EXIF datetime.\n  hasher = hashlib.md5()\n\nImpact: Prevent confusion in security audits\nEffort: 2 minutes","status":"closed","priority":3,"issue_type":"task","assignee":"@me","estimated_minutes":2,"created_at":"2026-01-08T13:25:01.195947+01:00","created_by":"ajo","updated_at":"2026-01-08T13:31:13.476533+01:00","closed_at":"2026-01-08T13:31:13.476533+01:00","close_reason":"Closed"}
{"id":"photosort-xmk","title":"CRITICAL: Remove unused exceptions.py file","description":"The exceptions.py file has 0% test coverage and is completely unused in the codebase. The DirError and Error classes defined in it are never imported or used anywhere.\n\nImpact: Technical debt, adds confusion\nEffort: 5 minutes\n\nAction: Delete src/photosort/exceptions.py","status":"closed","priority":0,"issue_type":"task","assignee":"@me","estimated_minutes":5,"created_at":"2026-01-08T13:24:58.860939+01:00","created_by":"ajo","updated_at":"2026-01-08T13:27:10.557254+01:00","closed_at":"2026-01-08T13:27:10.557254+01:00","close_reason":"Closed"}
